<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>ESP8266 Smart Monitor</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
  font-family:sans-serif;
  background:#111;
  color:white;
  text-align:center;
}
.container{
  max-width:500px;
  margin:auto;
  padding:20px;
}
.card{
  background:#222;
  margin:15px 0;
  padding:20px;
  border-radius:15px;
}
.value{
  font-size:40px;
  font-weight:bold;
}
button{
  font-size:18px;
  padding:12px 25px;
  margin:10px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
.on{background:#e74c3c;}
.off{background:#2ecc71;}
.alarmOn{color:#ff4444;font-size:22px;}
.alarmOff{color:#2ecc71;font-size:22px;}
</style>
</head>

<body>

<div class="container">

<h1>ğŸŒ± ESP8266 Smart Sensor</h1>

<div class="card">
<h3>ğŸ’§ à¸„à¸§à¸²à¸¡à¸Šà¸·à¹‰à¸™à¸”à¸´à¸™</h3>
<div id="soil" class="value">-- %</div>
</div>

<div class="card">
<h3>ğŸŒ¡ï¸ à¸­à¸¸à¸“à¸«à¸ à¸¹à¸¡à¸´</h3>
<div id="temp" class="value">-- Â°C</div>
</div>

<div class="card">
<h3>ğŸš¨ à¸ªà¸–à¸²à¸™à¸° Alarm</h3>
<div id="alarm" class="alarmOff">-</div>
</div>

<div class="card">
<h3>ğŸ”” à¸„à¸§à¸šà¸„à¸¸à¸¡ Buzzer</h3>
<button class="on" onclick="setAlarm(true)">à¹€à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡</button>
<button class="off" onclick="setAlarm(false)">à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡</button>
</div>

</div>

<script>

/* ===== Firebase Config ===== */
var firebaseConfig = {
  apiKey: "AIzaSyC1a-XkNqLQ-fR9K9G3rRq4H3k9SKw9EF0",
  databaseURL: "https://kjszz-1a818-default-rtdb.firebaseio.com/"
};

firebase.initializeApp(firebaseConfig);
var db = firebase.database();

/* ===== READ SENSOR REALTIME ===== */

db.ref("/sensor/soil").on("value",snap=>{
 document.getElementById("soil").innerText =
 (snap.val() ?? "--") + " %";
});

db.ref("/sensor/temperature").on("value",snap=>{
 document.getElementById("temp").innerText =
 (snap.val() ?? "--") + " Â°C";
});

db.ref("/sensor/alarm").on("value",snap=>{
 let state = snap.val();
 let el = document.getElementById("alarm");

 if(state){
   el.innerText="ğŸ”´ Alarm à¸—à¸³à¸‡à¸²à¸™";
   el.className="alarmOn";
 }else{
   el.innerText="ğŸŸ¢ à¸›à¸à¸•à¸´";
   el.className="alarmOff";
 }
});

/* ===== CONTROL ===== */
function setAlarm(state){
 db.ref("/control/enable").set(state);
}

</script>

</body>
</html>
